<!DOCTYPE html>
<html>
<head>
  <title>SmartQ Campus - Student</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h1>SmartQ Campus</h1>
  <nav>
    <button onclick="showSection('menu')">Menu</button>
    <button onclick="showSection('cart')">Cart</button>
    <button onclick="showSection('status')">Order Status</button>
    <button onclick="openCanteen()">Canteen Dashboard</button>
  </nav>
</header>

<!-- MENU -->
<section id="menu" class="section">
  <h2>Menu</h2>

  <div class="item">
    <span>Veg Meal - ₹50</span>
    <button onclick="addToCart('Veg Meal',50)">Add</button>
  </div>

  <div class="item">
    <span>Chicken Biryani - ₹120</span>
    <button onclick="addToCart('Chicken Biryani',120)">Add</button>
  </div>
</section>

<!-- CART -->
<section id="cart" class="section hidden">
  <h2>Cart</h2>
  <ul id="cartItems"></ul>
  <p><strong>Total: ₹<span id="total">0</span></strong></p>
  <button onclick="confirmOrder()">Confirm Order</button>
</section>

<!-- STATUS -->
<section id="status" class="section hidden">
  <h2>Order Details</h2>
  <div id="orderDetails">
    <p>No order placed yet.</p>
  </div>
  <button onclick="simulateRFID()">Simulate RFID Payment</button>
</section>

<script>
let cart = [];
let total = 0;

function showSection(id) {
  document.getElementById("menu").classList.add("hidden");
  document.getElementById("cart").classList.add("hidden");
  document.getElementById("status").classList.add("hidden");

  document.getElementById(id).classList.remove("hidden");
}

function addToCart(item, price) {
  cart.push({item, price});
  total += price;
  updateCart();
  showSection("cart");
}

function updateCart() {
  const list = document.getElementById("cartItems");
  list.innerHTML = "";

  cart.forEach(c => {
    const li = document.createElement("li");
    li.textContent = c.item + " - ₹" + c.price;
    list.appendChild(li);
  });

  document.getElementById("total").textContent = total;
}

function confirmOrder() {
  if(cart.length === 0){
    alert("Cart is empty!");
    return;
  }

  const orderId = "SQ" + Math.floor(1000 + Math.random()*9000);

  const order = {
    id: orderId,
    items: cart,
    total: total,
    status: "Payment Pending",
    eta: "10 mins"
  };

  localStorage.setItem("currentOrder", JSON.stringify(order));
  displayOrder();
  showSection("status");
}

function displayOrder() {
  const data = localStorage.getItem("currentOrder");
  if(!data) return;

  const order = JSON.parse(data);

  let html = `
    <p><strong>Order ID:</strong> ${order.id}</p>
    <p><strong>Total:</strong> ₹${order.total}</p>
    <p><strong>ETA:</strong> ${order.eta}</p>
    <p><strong>Status:</strong> ${order.status}</p>
  `;

  document.getElementById("orderDetails").innerHTML = html;
}

function simulateRFID() {
  const data = localStorage.getItem("currentOrder");
  if(!data) return;

  const order = JSON.parse(data);
  order.status = "Paid & Preparing";
  localStorage.setItem("currentOrder", JSON.stringify(order));

  displayOrder();
}

function openCanteen() {
  window.location.href = "canteen.html";
}

window.onload = function() {
  showSection("menu");
  displayOrder();
};
</script>

</body>
</html>
